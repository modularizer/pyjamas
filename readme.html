<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pyjamas</title>

    <script src="https://cdn.jsdelivr.net/pyodide/v0.20.0/full/pyodide.js"></script>
    <link rel="stylesheet" href = "https://codemirror.net/lib/codemirror.css"/>
    <script src="https://codemirror.net/lib/codemirror.js"></script>
    <script defer src="https://codemirror.net/mode/python/python.js"></script>
    <style>
        .CodeMirror {
          border: 1px solid #eee;
          height: auto;
        }
    </style>
    <script src="./pyjamas.js"></script>
</head>
<body>
<h1 id="pyjamas">Pyjamas</h1>
<p><em>By Torin Halsted</em></p>

<h2 id="getting-started">Getting Started</h2>
<p>Welcome to <strong>Pyjamas!</strong></p>
<p> <strong>Pyjamas</strong> is a minimal script to help you get started playing around with <a href="#pyodide"><strong>Pyodide</strong></a>, which allows you to run front-end Python and easily interact between Python, javascript and HTML.  In fact, &gt;99% of the functionaly of <strong>Pyjamas</strong> comes directly from pyodide object, which is made available at <code>window.pyodide</code>.</p>
<p>Pyjamas is inspired <a href="#pyscript"><strong>Pyscript</strong></a>, a project backed by Anaconda which provided a useful interface for pyodide also but introduced a <a href="#pyscript-drawbacks">list of drawbacks</a> in the process.</p>
<p>Similarly to PyScripts <a href="https://anaconda.cloud/api/files/803653a5-9b1e-41d4-a9ee-76c64b8d6cb4"><code>&lt;py-env&gt;</code></a>, <a href="https://anaconda.cloud/api/files/c57a6ef0-dbb7-43da-acd9-94a781ef2673"><code>&lt;py-script&gt;</code></a> and <a href="https://pyscript.net/examples/repl.html"><code>&lt;py-repl&gt;</code></a> tags,
Pyjamas provides the following tags:</p>
<ul>
<li><a href="#pyjamas-env"><code>&lt;pyjamas-env&gt;</code></a></li>
<li><a href="#pyjamas-script"><code>&lt;pyjamas-script&gt;</code></a></li>
<li><a href="#pyjamas-editor"><code>&lt;pyjamas-editor&gt;</code></a></li>
<li><a href="#pyjamas-repl"><code>&lt;pyjamas-repl&gt;</code></a></li>
</ul>
<p>See the full example HTML <a href="#">here</a></p>

<h2 id="import">Import</h2>
<p>Pyjamas is dependant on <strong>Pyodide</strong>.
<strong>CodeMirror</strong> is also used for styling the editor, but is not necessary.</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- import Pyodide--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>  <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/pyodide/v0.20.0/full/pyodide.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- import CodeMirror to make pyjamas-editor prettier (not necessary--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://codemirror.net/mode/python/python.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"https://codemirror.net/lib/codemirror.css"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://codemirror.net/lib/codemirror.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"> <span class="hljs-selector-class">.CodeMirror</span> { <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#eee</span>; <span class="hljs-attribute">height</span>: auto; } </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- import Pyjamas --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./pyjamas.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
</code></pre>


<h2 id="pyjamas-env">Pyjamas-Env</h2>
<p>The <code>&lt;pyjamas-env&gt;</code> tag allows you to load libraries using <a href="https://pyodide.org/en/stable/usage/api/js-api.html#pyodide.loadPackage">pyodide.loadPackage</a> function. Accepted inputs are either innerHTML or a <code>src</code> attribute linking to a file like a <code>requirements.txt</code>. </p>
<p>The package names are selected from the text using the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions">regular expression</a> <code>/\s*-?\s*(.*?)\s*[==[0-9|.]*]?\s*[,|;|\n]/g</code></p>
<p><strong>note</strong>: <em>the <code>==version</code> syntax used by <code>pip freeze</code> is ignored by the RegExp above, so specifying versions will not cause an error, but will not actually load that particular version, because this is not supported by pyodide</em></p>

<h4 id="env-examples">examples</h4>
<pre><code class="lang-html"> &lt;pyjamas-env&gt;
    -<span class="ruby"> numpy
</span>    -<span class="ruby"> datetime
</span>&lt;/pyjamas-env&gt;
</code></pre>

<pre><code class="lang-html"> <span class="hljs-tag">&lt;<span class="hljs-name">pyjamas-env</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./requirements.txt"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pyjamas-env</span>&gt;</span>
</code></pre>


<h2 id="pyjamas-script">Pyjamas-Script</h2>
<p> The <code>&lt;pyjamas-script&gt;</code> tag allows you to run Python code using <a href="https://pyodide.org/en/stable/usage/api/js-api.html?highlight=loadpac#pyodide.loadPackagesFromImports"><code>pyodide.loadPackageFromImports</code></a> followed by <a href="https://pyodide.org/en/stable/usage/api/js-api.html?highlight=runpythona#pyodide.runPythonAsync"><code>pyodide.runPythonAsync</code></a>. Accepted inputs are either innerHTML or a <code>src</code> attribute linking to a python file.</p>

<h4 id="script-examples">examples</h4>
<pre><code class="lang-html"> &lt;pyjamas-<span class="hljs-keyword">script</span> src=<span class="hljs-string">"./my-script.py"</span>&gt;&lt;/pyjamas-<span class="hljs-keyword">script</span>&gt;
</code></pre>
<pre><code class="lang-html"> &lt;pyjamas-script id=<span class="hljs-string">"testScript"</span>&gt;
     from js import document
     import datetime

     el = document.getElementById(<span class="hljs-string">"testScript"</span>)
     el<span class="hljs-selector-class">.style</span><span class="hljs-selector-class">.display</span> = <span class="hljs-string">"block"</span>
     el<span class="hljs-selector-class">.innerText</span> = str(datetime<span class="hljs-selector-class">.datetime</span><span class="hljs-selector-class">.now</span>().isoformat())
&lt;/pyjamas-script&gt;
</code></pre>
<pyjamas-script id="testScript">
     from js import document
     import datetime
     el = document.getElementById("testScript")
     el.style.display = "block"
      el.innerText = str(datetime.datetime.now().isoformat())
</pyjamas-script>



<h2 id="pyjamas-editor">Pyjamas-Editor</h2>
<p> The <code>&lt;pyjamas-editor&gt;</code> tag is similar to the  <code>&lt;pyjamas-script&gt;</code> tag, except instead of executing as soon as possible when the page is loaded, the tag provides a <a href="https://codemirror.net/6/">CodeMirror</a> text editor element and does not execute until the gutter start button has been pressed. Then, the editor runs the code, streaming STDOUT and STDERR to the console, and the displays the result as a string in the editor. Additionally, the element can be reset and the code can be modified and rerun.</p>

<h4 id="editor-examples">examples</h4>
<pre><code class="lang-html"> &lt;pyjamas-editor&gt;
     <span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
    np.random.rand(<span class="hljs-number">5</span>)
&lt;/pyjamas-editor&gt;
</code></pre>
<p>  <pyjamas-editor>
     import numpy as np
    np.random.rand(5)
</pyjamas-editor></p>



<h2 id="pyjamas-repl">Pyjamas-Repl</h2>
<p> The <code>&lt;pyjamas-repl&gt;</code> tag provides a minimal terminal emulator to play around with <code>pyodide</code>. It does the very basics and nothing more (no special color strings, no plots, etc.). It can be styled, but that is about it.</p>
<p> <a href="https://pyodide.org/en/stable/console.html">Pyodide&#39;s own console</a>  has much more support.</p>

<h4 id="repl-examples">examples</h4>
<pre><code class="lang-html"><span class="hljs-section">&lt;pyjamas-repl&gt;</span><span class="hljs-section">&lt;/pyjamas-repl&gt;</span>
</code></pre>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">pyjamas-repl</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">cols</span>=<span class="hljs-string">"80"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background-color:dark green; color:#fff"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pyjamas-repl</span>&gt;</span>
</code></pre>
<p><pyjamas-repl rows="10" cols="80" style="background-color:dark green; color:#fff"></pyjamas-repl></p>



<h2 id="pyodide">Pyodide</h2>
<p><a href="https://pyodide.org/en/stable/"><strong>Pyodide</strong></a> is a super cool project which runs a <a href="https://en.wikipedia.org/wiki/CPython"><strong>CPython interpreter</strong></a> in the browser using <a href="https://webassembly.org/"><strong>WebAssembly</strong></a> and provides access to <a href="https://developer.mozilla.org/en-US/docs/Web/API"><strong>WebAPIs</strong></a> ( such as <code>window</code>, <code>document</code>, etc. ) and all of you <strong>javascript</strong> objects, functions, etc. from <strong>Python</strong> and vice-versa. <strong>Pyodide</strong> provides <code>~99.9%</code> of the utility of <strong>Pyjamas</strong>.</p>
<p><strong>Pyodide</strong> is a great foundation  with cool features, <a href="https://pyodide.org/en/stable/"><strong>great documentation</strong></a> and lots of potential use cases mostly related to:</p>
<ul>
<li>offloading computations to browsers to reduce server resources</li>
<li>speeding up slow client-side computations (especially ones which can be <a href="https://www.intel.com/content/www/us/en/developer/articles/technical/vectorization-a-key-tool-to-improve-performance-on-modern-cpus.html">vectorized</a>) </li>
<li>distributing research and data analysis documents (this was the goal of the now-deprecated <a href="https://github.com/iodide-project/iodide">Iodide Project</a> from which Pyodide originated)</li>
<li>allowing Python developers to dabble in web development a bit easier</li>
</ul>
<p>Pyodide&#39;s main drawback is load time, with initial load time often taking ~2-6 seconds.</p>




<h2 id="pyscript">PyScript</h2>
<p><strong>Pyjamas</strong> is heavily inspired by <a href="https://pyscript.net/"><strong>PyScript</strong></a>, a project recently endorsed by <a href="https://anaconda.cloud/pyscript-python-in-the-browser">Anaconda</a> (May 2022), which is built on top of Pyodide and attempts to make Pyodide easier to use by providing <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements">custom HTML tags</a> such as <code>py-env</code>, <code>py-script</code> and <code>py-repl</code> and by allowing users to easily displayplots and graphs using <a href="https://matplotlib.org/3.5.0/gallery/index.html">matplotlib</a> and other similar popular Python Libraries.</p>
<h3 id="pyscript-drawbacks">PyScript drawbacks</h3>
<p>Unfortunately, <a href="https://pyscript.net/"><strong>PyScript</strong></a> has more drawbacks than features:</p>
<ul>
<li>very slow load times (10-30s)</li>
<li>poor documentation</li>
<li>poorly maintained: As of 5/14/2022, the <a href="https://pyscript.net/examples/hello_world.html">Hello World example</a> for PyScript does not even work</li>
<li>the <code>pyodide</code> object which Pyscript is based off of is not easily provided to the user as a <code>window</code> variable, <code>loadPyodide()</code> does not allow reloading of the <code>pyodide</code> object, and no documented interface to <code>pyodide</code> is provided, meaning the user loses out on most of pyodide&#39;s javascript API and versatility</li>
</ul>
<p>Pyscript seems to be so focused on making web development &quot;accessible&quot; to Python developers, that they ended up removing most of the Pyodide functionality developers are looking for and instead made a <strong>slow, bulky, buggy, front-end version of a <a href="https://jupyter.org/">Jupyter notebook</a>.</strong></p>



<h2 id="markdown-html-conversion">Markdown &gt; HTML Conversion</h2>
<p>This document was converted by <a href="https://markdowntohtml.com/">https://markdowntohtml.com/</a></p>

</body>
</html>